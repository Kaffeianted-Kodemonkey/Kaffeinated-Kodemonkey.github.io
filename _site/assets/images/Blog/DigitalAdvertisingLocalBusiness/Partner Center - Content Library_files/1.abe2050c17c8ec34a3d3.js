(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{C9Z2:function(e,t,i){"use strict";var n=i("F/XL"),r=i("dzgT"),s=i("K9Ia"),c=i("26FU"),a=i("gIcY"),o=i("o3x0"),l=i("scf+"),u=i("kk/1"),d=i("ad02"),p=i("15JJ"),h=i("t9fZ"),b=i("klSw"),f=i("VnD/"),g=i("67Y/"),m=i("/PH2"),v=i("xMyE"),k=i("Gi3i"),y=i("p0Sj"),I=i("FYXD"),O=i("ey9i"),P=i("R6jH"),S=(i("Q7VK"),i("j5LR"),i("Emlk"));function j(e,t){var i=[];if(!((e&&e.products&&0!==e.products.length||e&&e.addon_keys&&0!==e.addon_keys.length)&&t&&t.length>0))return[];var n=Object(O.G)(t),r=e.products,s=e.addon_keys;return r&&r.length>0&&r.map(function(e){return n.get(e)}).filter(Boolean).forEach(function(e){i.push({app_id:e.appId,quantity:1})}),s&&s.length>0&&s.forEach(function(e){var t=n.get(e.addonId||e.addon_id);t&&i.push({app_id:t.appId,addon_id:t.addonId,quantity:e.quantity||1})}),i}i.d(t,"a",function(){return $});var $=function(){function e(e,t,i,n,r,a,o,l,u,d,p,h){this.formBuilder=e,this.changeDetectorRef=t,this.marketsService=i,this.packageService=n,this.route=r,this.router=a,this.dialog=o,this.alertService=l,this.hidePricingGuard=u,this.contractDetailsService=d,this.packageFormService=p,this.accessService=h,this.selectedResellerItemIds$=new c.a([]),this.resellerItemOrder$=new c.a([]),this.toggleAdvancedSettings$=new s.a,this.navigateToManageStore$=new s.a,this.showIconsAndNameValueChanged$=new s.a,this.iconNameDetailsCheckboxDefaults$=new s.a,this.openDialog$=new s.a,this.dialogOpen$$=new c.a(!1),this.billedProductLoaded=new Map,this.submitting=!1,this.subscriptions=[],this.clickedAdvancedSettings=!1,this.sellingPriceTooltip='When a given client selects a package in your Store, they will see this price. Check the "Contact Sales" checkbox or leave the price field blank to show "Contact Sales", or enter \u201c0\u201d to show \u201cFree\u201d.',this.iconTooltip="\n      Recommended Dimensions: 120px x 120px\n\n      Recommended aspect ratio: 1:1\n\n      Maximum file size: 2 MB",this.billingFrequencyOptions=this.selectableBillingFrequency(),this.selectedFrequencyPrice=O.d.fromKey(O.h),this.selectedFrequencyAdditionalPrice=O.d.fromKey(O.h),this.currencyOptions=["USD","CAD","AUD","BRL","CHF","CNY","CZK","EUR","GBP","HKD","INR","JPY","KHR","KRW","MXN","NOK","NZD","RUB","SEK","SGD","TRY","ZAR"],this.defaultCurrency="USD",this.fileUploadUrl="/_ajax/v1/marketplace/file/upload",this.disableShowProductDetails=!1,this.disableAddProducts=!0,this.showAdvancedContent=!1,this.additionalPriceVisible=!1,this.plugins="code media link image lists",this.toolbars="bold italic underline strikethrough alignleft alignright bullist numlist outdent indent link unlink media image code",this.menubars="format insert tools"}return Object.defineProperty(e.prototype,"selectedResellerItems",{set:function(e){var t=e.map(function(e){return{app_id:e.appId,addon_id:e.addonId,quantity:e.quantity}});this.selectedResellerItemIds$.next(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedResellerItemIds",{set:function(e){this.selectedResellerItemIds$.next(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEditing",{get:function(){return this.packageId$.pipe(Object(g.a)(Boolean))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasAccessToMarkets$",{get:function(){return this.accessService.hasAccessToFeature("markets-access")},enumerable:!0,configurable:!0}),e.prototype.onResellerItemOrderChanged=function(e){this.resellerItemOrder$.next(e)},e.prototype.ngOnInit=function(){var e=this;this.resellerItemsTableConfig$=this.hidePricingGuard.canActivate().pipe(Object(g.a)(function(e){return{showRemove:!0,sortable:!1,sortedAlphabetically:!1,allowReorder:!0,addonIndented:!1,hidePricing:e,showQuantity:!0,showQuantitySpinner:!1}})),this.approvedResellerItems$=this.packageFormService.activatableResellerItems$.pipe(Object(b.a)(1)),this.resellerItems$=this.packageFormService.resellerItems$.pipe(Object(b.a)(1)),this.billedProductsMap$=this.packageFormService.billedProducts$.pipe(Object(g.a)(function(e){var t=new Map;return e&&0!==e.length?(e.forEach(function(e){t.set(e.productId,e)}),t):t})),this.billedProductsMap$.pipe(Object(v.a)(function(){Array.from(e.packageFormService.billedProductsLoaded.entries()).forEach(function(t){e.billedProductLoaded.set(t[0],t[1])})})).subscribe(),this.selectedResellerItems$=Object(r.b)(this.resellerItems$,this.selectedResellerItemIds$.asObservable()).pipe(Object(g.a)(function(e){var t=e[0];return e[1].reduce(function(e,i){var n=t.find(function(e){return e.appId===i.app_id&&e.addonId===i.addon_id});return n&&(n.quantity=i.quantity,e.push(n)),e},[])}),Object(b.a)(1)),this.subscriptions.push(this.selectedResellerItems$.pipe(Object(v.a)(function(t){return t.length?e.updateTableProducts(t):void 0})).subscribe()),this.subscriptions.push(this.resellerItems$.pipe(Object(v.a)(function(){return e.disableAddProducts=!1}),Object(b.a)(1)).subscribe()),this.subscriptions.push(this.selectedResellerItemIds$.subscribe(function(t){e.form&&e.form.patchValue({resellerItems:t})})),this.packageId$=this.route.params.pipe(Object(I.a)("id")),this.pkg$=this.packageId$.pipe(Object(d.a)(),Object(p.a)(function(t){return t?e.packageService.getPackageById(t):Object(n.a)(void 0)}),Object(b.a)(1));var t=Object(r.b)(this.pkg$.pipe(Object(f.a)(Boolean)),this.resellerItems$).pipe(Object(g.a)(function(e){return j(e[0],e[1]||[])}));this.subscriptions.push(t.subscribe(function(t){e.selectedResellerItemIds=t})),this.subscriptions.push(Object(r.b)(t,this.resellerItems$).pipe(Object(g.a)(function(e){var t=e[0],i=e[1];if(!i||!t)return[];var n=Object(S.g)(i);return t.map(function(e){return n.get(Object(S.e)(e))})}),Object(f.a)(function(e){return e&&e.length>0}),Object(h.a)(1),Object(v.a)(function(t){e.resellerItemOrder$.next(t)})).subscribe()),this.subscriptions.push(Object(r.b)(this.pkg$,this.selectedResellerItems$,this.resellerItems$,this.resellerItemsTableConfig$).pipe(Object(v.a)(function(t){e.setupForm(t[1]||[],t[2]||[],t[3],t[0])})).subscribe()),this.subscriptions.push(Object(r.b)(this.marketsService.selectedMarketOrDefault,this.pkg$).pipe(Object(p.a)(function(t){var i=t[0],r=t[1];return r&&r.market_id?e.marketsService.getMarket(r.market_id):Object(n.a)(i)})).subscribe(function(t){e.selectedMarket=t,e.form&&e.form.patchValue({market:t?t.name:""})})),this.title$=this.isEditing.pipe(Object(g.a)(function(e){return e?"Edit Package":"Create Package"})),this.packagePricingInfo$=this.selectedResellerItems$.pipe(Object(p.a)(function(t){var i=t.map(function(e){return Object(S.e)(e)});return e.packageFormService.getPackagePricingInfos$(i)})),this.subscriptions.push(this.toggleAdvancedSettings$.pipe(Object(m.a)(this.selectedResellerItems$),Object(v.a)(function(t){e.toggleAdvancedSettingsImplementation(t[1])})).subscribe()),this.subscriptions.push(this.iconNameDetailsCheckboxDefaults$.pipe(Object(m.a)(this.selectedResellerItems$),Object(v.a)(function(t){e.iconNameDetailsCheckboxDefaultsImplementation(t[1])})).subscribe()),this.subscriptions.push(this.navigateToManageStore$.pipe(Object(m.a)(this.pkg$)).subscribe(function(t){var i=t[1];e.goToManageStore(i&&i.market_id?i.market_id:e.getSelectedMarketId())})),this.subscriptions.push(this.showIconsAndNameValueChanged$.pipe(Object(m.a)(this.selectedResellerItems$),Object(v.a)(function(t){e.showIconsAndNamesValueChangedImplementation(t[1])})).subscribe()),this.sortedSelectedResellerItems$=Object(r.b)(this.resellerItemOrder$,this.selectedResellerItems$).pipe(Object(g.a)(function(e){var t=e[1],i=(e[0]||[]).concat(t||[]),n=Object(S.g)(t),r=[];return i.forEach(function(e){r.includes(Object(S.e)(e))||r.push(Object(S.e)(e))}),r.reduce(function(e,t){var i=n.get(t);return i&&e.push(i),e},[])}),Object(b.a)(1));var i=this.openDialog$.pipe(Object(k.a)(100),Object(m.a)(this.dialogOpen$$),Object(f.a)(function(e){return!e[1]}),Object(m.a)(this.selectedResellerItems$.pipe(Object(y.a)([])),this.approvedResellerItems$.pipe(Object(y.a)([])),Object(n.a)(this.billedProductsMap$)),Object(g.a)(function(t){var i=t[1],n=t[2],r=t[3],s=e.openDialogImplementation();return s.componentInstance.resellerItems=n,s.componentInstance.selectedResellerItems=i,s.componentInstance.billedProductsMap$=r,s.componentInstance.billedProductLoaded=e.billedProductLoaded,s}),Object(v.a)(function(){return e.dialogOpen$$.next(!0)}),Object(p.a)(function(e){return e.afterOpen().pipe(Object(g.a)(function(){return e}))}));Object(r.b)(i,this.selectedResellerItems$.pipe(Object(y.a)([])),this.approvedResellerItems$.pipe(Object(y.a)([])),Object(n.a)(this.billedProductsMap$)).pipe(Object(v.a)(function(t){var i=t[0],n=t[1],r=t[3];i&&i.componentInstance&&(i.componentInstance.resellerItems=t[2],i.componentInstance.selectedResellerItems=n,i.componentInstance.billedProductsMap$=r,i.componentInstance.billedProductLoaded=e.billedProductLoaded)}),Object(p.a)(function(t){return t[0].afterClosed().pipe(Object(v.a)(function(){return e.dialogOpen$$.next(!1)}))}),Object(v.a)(function(t){t&&(e.selectedResellerItems=t,e.updateTableProducts(t),t.length>1&&!e.showAdvancedContent&&e.toggleAdvancedSettings()),e.iconNameDetailsCheckboxDefaults()})).subscribe()},e.prototype.setupForm=function(e,t,i,n){var r=n||new O.m({pricing:{currency:this.defaultCurrency,prices:[{frequency:null,price:null}]},hide_product_details:!1,hide_product_icons_and_names:!1,products:[],addon_keys:[]});r=O.n.convertPriceFrequencyToLowercase(r);var s=n?j(n,t):[],c=!1;n&&(c=this.shouldContactSales(r));var o=r.pricing.prices.length>0?r.pricing.prices[0]:null,l=r.pricing.prices.length>1?r.pricing.prices[1]:null;this.form=this.formBuilder.group({icon:[r.icon],resellerItems:[s],products:[r.products,[a.B.minLength(1)]],addon_keys:[r.addon_keys,[a.B.minLength(0)]],market:[this.selectedMarket?this.selectedMarket.name:"Loading..."],name:[r.name,[a.B.required]],tagline:[r.tagline],headerImageUrl:[r.header_image_url],price:[o&&"number"==typeof o.price&&o.price>=0?(o.price/100).toString():null,[P.m.isPrice]],additionalPrice:[l&&"number"==typeof l.price?(l.price/100).toString():null,[P.m.isPrice]],"marketing-content":[r.content],currency:[r.pricing.currency?r.pricing.currency:this.defaultCurrency],"show-icons-and-names":[!r.hide_product_icons_and_names],"show-product-details":[!r.hide_product_details],contactSales:[c]}),o&&o.frequency&&(this.selectedFrequencyPrice=O.d.fromKey(o.frequency)),l&&l.frequency&&(this.selectedFrequencyAdditionalPrice=O.d.fromKey(l.frequency)),n?(this.additionalPriceVisible=r.pricing.prices.length>1&&!c,this.checkboxClicked=!0,this.updateTableProducts(e),this.iconNameDetailsCheckboxDefaults()):this.form.patchValue({name:null})},e.prototype.shouldContactSales=function(e){return 0===e.pricing.prices.length||e.pricing.prices.length>0&&-1!==e.pricing.prices.findIndex(function(e){return e.price===u.d||null===e.price})},e.prototype.toggleAdvancedSettings=function(){this.toggleAdvancedSettings$.next()},e.prototype.toggleAdvancedSettingsImplementation=function(e){!1===this.clickedAdvancedSettings&&1===e.length&&(this.form.value.name=e[0].name),this.clickedAdvancedSettings=!0,this.showAdvancedContent=!this.showAdvancedContent,this.changeDetectorRef.detectChanges()},e.prototype.openDialogImplementation=function(){var e=new o.h;e.width="60%";var t=this.dialog.open(P.f,e);return t.componentInstance.verb="Package",t},e.prototype.openDialog=function(){this.openDialog$.next()},e.prototype.iconNameDetailsCheckboxDefaults=function(){this.iconNameDetailsCheckboxDefaults$.next()},e.prototype.iconNameDetailsCheckboxDefaultsImplementation=function(e){(e=e||[]).length<2&&(this.disableShowProductDetails=!1),this.checkboxClicked?!this.form.value["show-icons-and-names"]&&e.length>1&&(this.form.patchValue({"show-product-details":!1}),this.disableShowProductDetails=!0):((0===e.length||e.length>1)&&this.form.patchValue({"show-icons-and-names":!0}),1===e.length&&(this.form.patchValue({"show-icons-and-names":!1}),this.disableShowProductDetails=!1))},e.prototype.productSelectionChanged=function(e){this.selectedResellerItems=e,this.updateTableProducts(e),this.iconNameDetailsCheckboxDefaultsImplementation(e)},e.prototype.updateTableProducts=function(e){this.tableRef&&((1===this.tableRef.resellerItems.length&&this.form.value.name===this.tableRef.resellerItems[0].name||1!==this.tableRef.resellerItems.length&&null==this.form.value.name)&&1===e.length&&this.form.patchValue({name:e[0].name}),1===this.tableRef.resellerItems.length&&1!==e.length&&this.form.value.name===this.tableRef.resellerItems[0].name&&this.form.patchValue({name:null}))},e.prototype.getSelectedMarketId=function(){return this.selectedMarket.market_id},e.prototype.showProductDetailsValueChanged=function(){this.checkboxClicked=!0},e.prototype.showIconsAndNamesValueChanged=function(){this.showIconsAndNameValueChanged$.next()},e.prototype.showIconsAndNamesValueChangedImplementation=function(e){this.checkboxClicked=!0,!this.form.value["show-icons-and-names"]&&e.length>1?(this.form.patchValue({"show-product-details":!1}),this.disableShowProductDetails=!0):this.disableShowProductDetails=!1},e.prototype.publish=function(){this.saveAs("publish")},e.prototype.saveDraft=function(){this.saveAs("draft")},e.prototype.invalidCountryCombination=function(e){for(var t=this,i=new Map,n=function(e){if(e&&e.restrictions&&e.restrictions.country){var n=e.restrictions.country.whitelist;if(n&&n.length>0){var r=!1;if(i.forEach(function(i,s){i.filter(function(e){return-1!==n.indexOf(e)}).length<=0&&(t.alertService.errorSnack(s+" and "+e.name+" do not share any supported countries"),r=!0)}),r)return{value:!0};i.set(e.name,n)}}},r=0,s=e;r<s.length;r++){var c=n(s[r]);if("object"==typeof c)return c.value}return!1},e.prototype.saveAs=function(e){var t=this,i=Object(r.b)(this.selectedResellerItemIds$.asObservable(),this.sortedSelectedResellerItems$,this.pkg$).pipe(Object(h.a)(1),Object(g.a)(function(e){var i=e[0],n=e[1],r=e[2],s=t.form.value;if(!t.submitting){if(t.submitting=!0,!t.invalidCountryCombination(n)){var c=[];s.contactSales?c.push({price:u.d,frequency:t.selectedFrequencyPrice.key}):(s.price||0===s.price)&&(c.push({price:100*s.price,frequency:t.selectedFrequencyPrice.key}),(s.additionalPrice||0===s.additionalPrice)&&c.push({price:100*s.additionalPrice,frequency:t.selectedFrequencyAdditionalPrice.key})),0===c.length&&c.push({price:u.d,frequency:t.selectedFrequencyPrice.key});var a={name:s.name,market_id:r&&r.market_id?r.market_id:t.getSelectedMarketId(),icon:s.icon,content:s["marketing-content"],addon_keys:n.map(function(e){return e.appId&&e.addonId?{app_id:e.appId,addon_id:e.addonId,quantity:e.quantity}:null}).filter(function(e){return null!==e}),products:n.map(function(e){return e.appId&&!e.addonId?e.appId:null}).filter(function(e){return null!==e}),hide_product_details:!s["show-product-details"],hide_product_icons_and_names:!s["show-icons-and-names"],pricing:{currency:l.f[s.currency],prices:c},tagline:s.tagline,header_image_url:s.headerImageUrl};return 1===i.length&&(a.name||(a.name=n[0].name),a.icon||(a.icon=n[0].icon)),a}t.submitting=!1}}),Object(g.a)(function(e){return new O.m(e)})),n=Object(f.a)(function(i){return"publish"!==e||!(!i.products||0===i.products.length)||!(!i.addon_keys||0===i.addon_keys.length)||(t.submitting=!1,t.alertService.errorSnack("This package must contain products / addons for it to be published"),!1)}),s=Object(r.b)(i.pipe(n),this.isEditing,this.packageId$).pipe(Object(h.a)(1),Object(p.a)(function(e){var i=e[0];return e[1]?(i.solution_id=e[2],t.packageService.updatePackage(i)):t.packageService.createPackage(i)}));Object(r.b)(s,this.isEditing).pipe(Object(h.a)(1)).subscribe(function(i){var n,r=i[0],s=i[1];"publish"!==e||r.isPublished?"draft"===e&&s&&(r.isPublished?n=t.packageService.unpublishPackage(r):r.isArchived&&(n=t.packageService.restorePackage(r))):n=t.packageService.publishPackage(r),null!=n?n.subscribe(function(){s?t.successAndNavigate(r,e):t.openPublishDialog(r,e)},function(i){t.submitting=!1,t.alertService.errorSnack("Unable to "+("publish"===e?"publish":"save draft")+".\n                                 Please refresh the page and try again.")}):s?t.successAndNavigate(r,e):t.openPublishDialog(r,e)},function(e){console.error(e),t.submitting=!1,t.alertService.errorSnack("Unable to update / create the package. Please refresh the page and try again.")})},e.prototype.successAndNavigate=function(e,t){var i="";"draft"===t?i=e.name+" was saved!":"publish"===t&&(i=e.name+" was published!"),this.alertService.success(i),this.navigateToManageStore$.next()},e.prototype.openPublishDialog=function(e,t){var i=this,n=this.dialogContent(e,t),r=new o.h;r.maxWidth="600px",this.vDialog=this.dialog.open(P.l,r),this.vDialog.componentInstance.title=n.title,this.vDialog.componentInstance.contentHtml=n.contentHtml,this.vDialog.componentInstance.buttons=[{title:"OK",action:""}],this.subscriptions.push(this.vDialog.afterClosed().pipe(Object(h.a)(1)).subscribe(function(){i.navigateToManageStore$.next()}))},e.prototype.dialogContent=function(e,t){var i,n;return"publish"===t&&(i=e.name+" was published to your Store!",n="<p>Your clients can now view "+e.name+" in your Store. Return to Manage at anytime to edit this package.</p>"),"draft"===t&&(i=e.name+" was saved to your Store!",n="<p>Your clients won't be able to see it in your store until it's published.\n                     Return to Manage at anytime to preview, edit, or publish this package from your Store.</p>"),{title:i,contentHtml:n}},e.prototype.cancel=function(){var e=this;this.subscriptions.push(this.route.queryParams.subscribe(function(t){e.goToManageStore(t.marketID||t.marketId)}))},e.prototype.goToManageStore=function(e){e&&this.marketsService.selectMarket(this.selectedMarket),this.router.navigateByUrl("marketplace/manage-store")},e.prototype.isFormValid=function(){return this.form.valid},e.prototype.showSubmit=function(){var e=this;return this.selectedResellerItemIds$.pipe(Object(h.a)(1),Object(g.a)(function(t){return e.isFormValid()&&t.length>0&&!e.submitting}))},e.prototype.showSaveDraft=function(){return!this.submitting},e.prototype.showAdditionalPrice=function(){this.additionalPriceVisible=!0},e.prototype.clearAdditionalPrice=function(){this.form.patchValue({additionalPrice:null}),this.additionalPriceVisible=!1},e.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(e){return e.unsubscribe()})},e.prototype.selectableBillingFrequency=function(){for(var e=[],t=0,i=O.c;t<i.length;t++)e.push(O.d.fromKey(i[t]));return e},e}()},HeFZ:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var n=function(){}},Q7VK:function(e,t,i){"use strict";i.d(t,"a",function(){return c}),i("ey9i");var n=i("klSw"),r=i("67Y/"),s=i("x1Tk"),c=function(){function e(e,t){this.resellerItemService=e,this.billedProductService=t,this.billedProductsLoaded=new Map,this.resellerItems$=this.resellerItemService.getPartnerData().pipe(Object(n.a)(1)),this.activatableResellerItems$=this.resellerItemService.getActivatablePartnerData().pipe(Object(n.a)(1)),this._billedProducts$=this.billedProductService.billedProducts$.pipe(Object(n.a)(1)),this.billedProductsLoaded=this.billedProductService.billedProductsLoaded,this.billedProductMap$=this._billedProducts$.pipe(Object(r.a)(function(e){var t=new Map;return e.forEach(function(e){e&&t.set(e.productId,e)}),t}),Object(n.a)(1)),this.packagePricingInfo$=this.resellerItems$.pipe(Object(s.a)(this.billedProductMap$),Object(r.a)(function(e){var t=e[0],i=e[1];if(!t)return[];var n=[];return t.forEach(function(e){n.find(function(t){return t.resellerItem.billingId===e.billingId})||n.push({resellerItem:e,billedProduct:i.get(e.billingId)})}),n}),Object(n.a)(1))}return Object.defineProperty(e.prototype,"billedProducts$",{get:function(){return this._billedProducts$},enumerable:!0,configurable:!0}),e.prototype.getPackagePricingInfos$=function(e){return this.packagePricingInfo$.pipe(Object(r.a)(function(t){return t.filter(function(t){var i=t.resellerItem.appId,n=t.resellerItem.addonId;return n?e.indexOf(n)>=0:e.indexOf(i)>=0})}))},e}()},Vd9I:function(e,t,i){"use strict";i.d(t,"a",function(){return c}),i("ey9i"),i("t63B"),i("j5LR");var n=i("67Y/"),r=i("klSw"),s=i("FCKb"),c=function(){function e(e,t,i,n,r,s,c){this.dialogRef=e,this.marketsService=t,this.alertService=i,this.partnerService=n,this.packageService=r,this.accessService=s,this.data=c,this.pkg=c.pkg}return e.prototype.ngOnInit=function(){var e=this;this.partnerId=this.partnerService.partnerId,this.markets$=Object(s.combineLatest)(this.marketsService.getSortedMarkets(),this.accessService.hasAccessToFeature("markets-access")).pipe(Object(n.a)(function(t){return t[1]?t[0]:[e.currentMarket]}),Object(r.a)(1)),this.currentMarket=this.marketsService.currentMarket,this.hasAccessToMarkets$=this.accessService.hasAccessToFeature("markets-access").pipe(Object(r.a)(1))},e.prototype.onSubmit=function(e){var t=this;this.packageService.copyPackage(this.pkg.solution_id,this.partnerId,e.selectedMarketIds,e.contactSales,e.name,e.status,e.currency?e.currency.toUpperCase():e.currency,e.price,e.additionalPrice,e.frequency?e.frequency.toUpperCase():e.frequency,e.additionalFrequency?e.additionalFrequency.toUpperCase():e.additionalFrequency).subscribe(function(i){t.alertService.successSnack("Copying "+e.name+" to selected market(s). This may take a minute.")},function(e){t.alertService.errorSnack("An error occurred, Packages could not be copied.")}),this.dialogRef.close()},e.prototype.onNoClick=function(){this.dialogRef.close()},e}()},bHVG:function(e,t,i){"use strict";i.d(t,"a",function(){return r}),i.d(t,"b",function(){return s});var n=i("CcnG"),r=(i("gIcY"),i("VMde"),i("HyEY"),i("2itE"),i("Z5Ki"),n["\u0275crt"]({encapsulation:2,styles:[],data:{}}));function s(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,0,"textarea",[],[[8,"id",0]],null,null,null,null))],null,function(e,t){e(t,0,0,n["\u0275inlineInterpolate"](1,"",t.component.elementId,""))})}},yv9o:function(e,t,i){"use strict";i.d(t,"a",function(){return p});var n=i("ey9i"),r=i("kk/1"),s=i("Jbla"),c=i("67Y/"),a=i("15JJ"),o=i("Vd9I"),l=i("FCKb"),u=(i("wkOq"),i("gGKu")),d=i("I65S"),p=function(){function e(e,t,i,n,r,s,c,a,o){this.resellerItemService=e,this.billedProductService=t,this.contractDetailsService=i,this.packageService=n,this.addonsService=r,this.productService=s,this.route=c,this.dialog=a,this.marketplaceAppService=o,this.billedProductLoaded=!1}return e.prototype.ngOnInit=function(){var t=this;this.package_id=this.route.snapshot.params.id,this.package$=this.packageService.getPackageById(this.package_id),this.breadcrumbs$=this.package$.pipe(Object(c.a)(function(e){return t.buildBreadcrumbs(e.name)})),this.addons$=this.package$.pipe(Object(a.a)(function(e){return e.addon_keys&&e.addon_keys.length>0?t.addonsService.getMultiAddons(e.addon_keys):Object(d.of)([])})),this.apps$=this.package$.pipe(Object(a.a)(function(e){return t.marketplaceAppService.apps.pipe(Object(c.a)(function(t){return t.filter(function(t){if(e.products.find(function(e){return t.appId===e}))return!0})}))})),this.storeProducts$=this.apps$.pipe(Object(c.a)(function(t){var i=[];return t.forEach(function(t){i.push(e.converProducttoStoreProduct(e.convertAppToProduct(t)))}),i})),this.useThisButton$=this.package$.pipe(Object(c.a)(function(e){return{title:"Copy",callback:function(){return t.copyDialog(e)}}})),this.resellerItems$=this.package$.pipe(Object(a.a)(function(e){return Object(l.combineLatest)(t.apps$,t.addons$).pipe(Object(c.a)(function(e){var t=e[1],i=[];return e[0].forEach(function(e){return i.push(Object(u.b)(e))}),t.forEach(function(e){return i.push(Object(u.a)(e,null))}),i}))})),this.packagePricingInfo$=this.resellerItems$.pipe(Object(a.a)(function(e){return t.getPricingInfos(e)})),this.data$=Object(l.combineLatest)(this.package$,this.addons$,this.storeProducts$,this.useThisButton$).pipe(Object(c.a)(function(e){return{pkg:e[0],addons:e[1],products:e[2],useThisButton:e[3]}})),this.isContractVerified$=this.contractDetailsService.contractVerified},e.prototype.buildBreadcrumbs=function(e){return[{url:"/marketplace/manage-store/recommended",text:"Manage Store"},{text:e}]},e.prototype.getPricing=function(e){return{prices:[{price:e.price,frequency:e.billingFrequency}],currency:e.currency}},e.prototype.getBilledProductLoaded=function(e){return this.billedProductLoaded},e.prototype.getBilledProduct=function(e){var t=this;return this.billedProductService.billedProducts$.pipe(Object(c.a)(function(i){return i.find(function(i){return t.billedProductLoaded=!0,i.productId===e.billingId})}))},e.prototype.getPricingInfos=function(e){return this.billedProductService.billedProducts$.pipe(Object(c.a)(function(t){var i=[];return e.forEach(function(e){i.push({billedProduct:t.find(function(t){return t.productId===e.billingId}),resellerItem:e})}),i}))},e.prototype.copyDialog=function(e){this.copyPackageDialog=this.dialog.open(o.a,{width:"50%",data:{pkg:e}})},e.converProducttoStoreProduct=function(e){var t=[];e.lmi_categories&&e.lmi_categories.length>0&&e.lmi_categories.forEach(function(e){return e&&t.push(e.name),""});var i=new r.t;return i.productId=e.product_id,i.billingId=e.billing_id,i.currency=e.currency,i.name=e.name,i.description=e.description,i.tagline=e.tagline,i.iconUrl=e.icon_url,i.screenshotUrls=e.screenshot_urls,i.keySellingPoints=e.key_selling_points,i.faqs=e.faqs,i.wholesalePrice=e.wholesale_price,i.billingFrequency=e.billing_frequency,i.lmiCategories=t,i},e.convertAppToProduct=function(e){var t=null;e.price>=0&&(t=e.price);var i=new n.r({productId:e.appId,name:e.name,description:e.description?e.description:"",tagline:e.tagline,iconUrl:e.icon,screenshotUrls:e.screenshot,pdfUploadUrls:e.pdfUpload?e.pdfUpload:[],keySellingPoints:e._keySellingPoints?e._keySellingPoints:[],faqs:e.faqs?e.faqs:[],wholesalePrice:t,restrictions:e.restrictions});return i.lmi_categories=e.lmiCategories&&e.lmiCategories.length>0?e.lmiCategories.map(function(e){return e?s.e[e]:[]}):[],i.currency=e.currency,i.billing_frequency=e.billingFrequency,i},e}()}}]);